<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.project.dwine.orderManage.model.dao.OrderManageMapper">

	<resultMap id="purchaseResultMap" type="com.project.dwine.orderManage.model.vo.Purchase">
		<id property="purchaseNo" column="PURCHASE_NO"/>
		<result property="purchaseDate" column="PURCHASE_DATE"/>
		<result property="usePoint" column="USE_POINT"/>
		<result property="purchasePrice" column="PURCHASE_PRICE"/>
		<result property="pickupDate" column="PICKUP_DATE"/>
		<result property="pickupPlace" column="PICKUP_PLACE"/>
		<result property="pickupTime" column="PICKUP_TIME"/>
		<result property="orderStatus" column="ORDER_STATUS"/>
		<result property="status" column="STATUS"/>
		<result property="refundDate" column="REFUND_DATE"/>
		<result property="userNo" column="USER_NO"/>
		<result property="userName" column="USER_NAME"/>
	</resultMap>
	
	<resultMap id="orderDetailResultMap" type="com.project.dwine.orderManage.model.vo.OrderDetail">
		<id property="odNo" column="OD_NO"/>
		<result property="odCount" column="OD_COUNT"/>
		<result property="odPrice" column="OD_PRICE"/>
		<result property="purchaseNo" column="PURCHASE_NO"/>
		<result property="productNo" column="PRODUCT_NO"/>
	</resultMap>
	
	<select id="selectOrderList" resultMap="purchaseResultMap">
		SELECT
		       P.PURCHASE_NO
		     , P.PURCHASE_DATE
		     , P.USE_POINT
		     , P.PURCHASE_PRICE
		     , P.PICKUP_DATE
		     , P.PICKUP_PLACE
		     , P.PICKUP_TIME
		     , P.ORDER_STATUS
		     , P.STATUS
		     , P.REFUND_DATE
		     , P.USER_NO
		     , M.USER_NAME
		  FROM PURCHASE P
		  LEFT JOIN MEMBER M ON(P.USER_NO = M.USER_NO)
		 WHERE STATUS = 'Y'
		 ORDER BY P.PURCHASE_NO DESC
	</select>
	
	<select id="stateChangeList" parameterType="string" resultMap="purchaseResultMap">
		SELECT
		       P.PURCHASE_NO
		     , P.PURCHASE_DATE
		     , P.USE_POINT
		     , P.PURCHASE_PRICE
		     , P.PICKUP_DATE
		     , P.PICKUP_PLACE
		     , P.PICKUP_TIME
		     , P.ORDER_STATUS
		     , P.STATUS
		     , P.REFUND_DATE
		     , P.USER_NO
		     , M.USER_NAME
		  FROM PURCHASE P
		  LEFT JOIN MEMBER M ON(P.USER_NO = M.USER_NO)
         WHERE P.ORDER_STATUS = #{ state }
           AND STATUS = 'Y'
		 ORDER BY P.PURCHASE_NO DESC
	</select>
	
	<!-- <update id="updateOrderStatus" parameterMap="com.project.dwine.orderManage.model.vo.Purchase">
		UPDATE PURCHASE
		   SET ORDER_STATUS = #{ orderStatus }
		 WHERE PURCHASE_NO = #{ purchaseNo }
	</update> -->

</mapper>