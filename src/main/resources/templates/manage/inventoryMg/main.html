<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org">
<head>
<meta charset="UTF-8">
<title>재고관리</title>
<meta name="_csrf" th:content="${_csrf.token}">
<meta name="_csrf_header" th:content="${_csrf.headerName}">
<script src="http://code.jquery.com/jquery-1.6.4.min.js"></script>
<link href="/css/common/common.css" rel="stylesheet">

    <style>
    #container {
            width: 1100px;
            margin: 0 auto;
            display: flex;
            justify-content: space-between;
            flex-wrap: nowrap;
            height: 1400px;
        }

        .snb {
            width: 200px;
            /* height: 2500px; */
            height: 100%;
        }
    .contents {
            width: 888px;
            height: 100%;
        }

        .inner {
            margin-top: 30px;
            margin-left: 27px;
            width: 836px;
        }
        a {
            text-decoration: none;
            color: #000;
        }

        .snb {
            width: 210px;
        }

        .snb_inner {
            width: 170px;
            margin: 30px auto 0;
        }
       /* 여기서부터 */
        .content {
            margin : 50px auto;
            height : auto;
            min-height : 100%;
            width: 900px;
        }

        .totalList{
            border: black 1px solid;
            width: 850px;
            height: 120px;
            display: flex;
            list-style: none;
            text-align: center;
            margin-bottom: 10px;
           
            
        }
        #totalStock{
            margin-right: 200px;
            margin-left: 160px;
        }

        #totalShop {
            margin-right: 200px;
        }
        
        #todayReceiving{
            margin-right: 150px;
        }
        span#count{
           font-size: 45px;
           font-weight: bolder;
           color: #83131E;   
        }
        span#counts{
           font-size: 45px;
           font-weight: bolder;
           color: black;  
        }
        span#countTitle{
           width: 70px;
        }
        .dayArrayBtn{
           margin: 5px;
           background: white ;
           border: 1px solid #83131E ;
           color: #83131E;
           width: 50px;
           height: 25px;
           border-radius: 5px; 
        }

        .dayArrayBtn:hover {
            cursor: pointer;
            transform:scale(1.1);
            background:  #83131E;
            color: white;  
        }
       

        #serarchBtn{
           margin: 5px;
           background: white ;
           border: 1px solid #83131E ;
           color: #83131E;
           width: 45px;
           height: 25px;
           border-radius: 5px;
        }
        #serarchBtn:hover {
            cursor: pointer;
            transform:scale(1.1);
            background:  #83131E;
            color: white;  
        }
        

        #registBtn{
            float: right;
            background: #83131E ;
            border: none;
            color:white;
            width:80px;
            height: 30px;
            border-radius: 5px;
            margin-right: 50px;
            margin-bottom: 10px;
        }

      .reviewList{
        margin-top: 20px;
        margin-bottom: 30px;
        width: 850px;
        height: 500px;
      }

      /* .arrayArea{
        display: right; 
      }
 */
      .stockList{
        border-collapse:collapse;
        font-display: center;  
        width : 850px;
        }

      .stockList th{
        border-left: none;
        background: lightgray;
        height: 35px;
        
      }

      .stockList td{
        border:1px solid lightgray;
        text-align: center;
        height: 35px;
        padding: 1px;
        font-size: 14px;
      }
      #cancleBtn{
        background: white ;
        border: 1px solid #83131E ;
        color: #83131E;
        width: 50px;
        height: 25px;
        border-radius: 8%;  
      }
      th:nth-of-type(11) { display: none; }   
      td:nth-of-type(11) { display: none; }
      
      
    </style>
</head>
<body>
<header th:include="common/header :: header"></header>
<div id="container"> 
  <nav class="snb" th:replace="/manage/adminSubmenu.html"></nav>
        
  <div class="content">
       
   <h2>입고관리</h2>    
    <hr>
    <div class="totalList">
     <input type="hidden" name="totalStock" th:value="${totalStock.totalStock}">
     <input type="hidden" name="totalShop" th:value="${totalShop.totalShop}">
     <input type="hidden" name="todayReceiving" th:value="${todayReceiving.todayReceiving}">
  
        <div id="totalStock">
            <span id="count"  th:text="${totalStock.totalStock}"></span> 
            <span id="countTitle">Total Stock</span>
        </div>
        <div id="totalShop">
            <span id="counts" th:text="${totalShop.totalShop}"></span> 
            <span id="countTitle">Total Shop</span>
        </div>
        <div id="todayReceiving">
            <span id="count" th:text="${todayReceiving.todayReceiving}">9</span>
            <span id="countTitle">Today Receiving</span>
        </div>
    </div> 
    
    <div class="searchArea">
        <label>기간 조회 : </label>
        <input type="date"> ~ <input type="date">
        <button class="dayArrayBtn">오늘</button>
        <button class="dayArrayBtn">1주일</button>
        <button class="dayArrayBtn">1개월</button>
        <div class="searchArea"><label>조건 검색 : </label>
            <select name="selectCategory">
                <option value="productName">상품명</option>
                <option value="productNo">상품번호</option>
            </select>
            <input type="text" id="searchTitle"> 
            <button id="serarchBtn">검색</button> 
        </div>

    </div>

        <button id="registBtn"  onclick="location.href='/manage/inventoryMg/regist'">입고</button><br>
        <div class="reviewList">
            <table class="stockList">
                <tr>
                <th>입고번호</th>
                <th>상품번호</th>
                <th>상품명(한글)</th>
                <th>상품명(영어)</th>
                <th>판매 가</th>
                <th>입고량</th>
                <th>입고단가</th>
                <th>지불 금액</th>
                <th>입고일</th>
                <th>기능</th>
                <th>상태</th>
                </tr>

                <tr class="allinven" th:each="inven: ${ invenList }">
                    <td id="inven_no"  th:text="${ inven.inven_no }"/>
                    <td th:text="${ inven.product_no }"/>
                    <td th:text="${ inven.product_kname }"/>
                    <td th:text="${ inven.product_ename }"/>
                    <td th:text="${#numbers.formatDecimal(inven.sale_price, 0, 'COMMA', 0, 'POINT')}"/>
                    <td th:text="${ inven.inven_count}"/>
                    <td th:text="${#numbers.formatDecimal(inven.cost_price, 0, 'COMMA', 0, 'POINT')}"/>
                    <td th:text="${#numbers.formatDecimal(inven.inven_price, 0, 'COMMA', 0, 'POINT')}"/>
                    <td th:text="${ #dates.format(inven.inven_date, 'yyyy-MM-dd') }"/>
                    <td><button class="cancleBtn" id="cancleBtn">취소</button></td>
                    <td class="tdStatus" th:text="${ inven.status }"></td>
                </tr>
                
            </table>
        </div>
</div>
</div>

    

<div th:replace="common/footer :: footer"></div>
<script>
	//crsf토큰
	var token = $("meta[name='_csrf']").attr("content");
	var header = $("meta[name='_csrf_header']").attr("content");
	$(document).ajaxSend(function(e, xhr, options) { xhr.setRequestHeader(header, token); });
	
	
	if($(".tdStatus").text = 'N'){
		$(".allinven").css('background', 'rgba(180,19,30,0.1)');
		$(".cancleBtn").hide();  
	}else{
		$(".allinven").css('background', 'none');
		$(".cancleBtn").show();  
	}; 
	
	

	// 삭제 confirm
	function checkConfirm() {
		if (confirm("정말 삭제하시겠습니까?"))
			return true
		else
			return false;
	}
	
	$(".cancleBtn").click(function(){
		var inven_no= $(this).parent().parent().children().eq(0).text();
		
		confirm("정말 취소하시겠습니까?");
		
		$.ajax({
			url : "/manage/inventoryMg/cancle",
			data : {inven_no, inven_no},
			type : "post",
			success : function(data) {
				console.log("성공하셨습니다.");
			},
			error : function(e) {
				console.log(e);
			}						
		});
	});

</script>
</body>
</html>